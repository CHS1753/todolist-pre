<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script>
    const username = sessionStorage.getItem('username');
    if(username===null) {
      location.href="login.html"
    }
  </script>
</head>
<body>
  <h1>할일 작성</h1>
  <input type="text" id="title">
  <input type="date" id="deadline">
  <button onclick="doWrite()">작성하기</button>
  <script>
    //상태 (state) : 기억할 값
    let tno = localStorage.getItem('tno');
    if (tno===null) {
      tno=1;
    } else {
      tno = +tno;
    }
    const todos = JSON.parse(localStorage.getItem('todos'))

    const doWrite = function () {

      const $title = document.getElementById('title').value;
      const $deadline = document.getElementById('deadline').value;
      const $writedate = new Date().toLocaleDateString();
      const todo = {tno:++tno, title:$title, writer:username ,writedate:$writedate, deadline:$deadline, finish:false};
      todos.push(todo);
      localStorage.setItem('todos',JSON.stringify(todos));
      localStorage.setItem('tno',tno);
      location.href = "index.html"
    }
  </script>
</body>
</html>